{"version":3,"sources":["/tools/isobuild/minifier-plugin.js"],"names":["module","export","JsFile","CssFile","buildmessage","watch","require","default","v","buildPluginModule","InputFile","constructor","source","options","_source","_arch","arch","_minifiedFiles","getContentsAsBuffer","contents","getPathInPackage","Error","getPackageName","getSourceHash","hash","getArch","error","message","sourcePath","line","column","func","relPath","getPathInBundle","file","undefined","targetPath","getSourceMap","sourceMap","addJavaScript","push","addStylesheet"],"mappings":";;AAAAA,OAAOC,MAAP,CAAc;AAACC,UAAO,MAAIA,MAAZ;AAAmBC,WAAQ,MAAIA;AAA/B,CAAd;AAAuD,IAAIC,YAAJ;AAAiBJ,OAAOK,KAAP,CAAaC,QAAQ,0BAAR,CAAb,EAAiD;AAACC,UAAQC,CAAR,EAAU;AAACJ,mBAAaI,CAAb;AAAe;;AAA3B,CAAjD,EAA8E,CAA9E;;AACxE,MAAMC,oBAAoBH,QAAQ,mBAAR,CAA1B;;AAEA,MAAMI,SAAN,SAAwBD,kBAAkBC,SAA1C,CAAoD;AAClDC,cAAYC,MAAZ,EAAoBC,UAAU,EAA9B,EAAkC;AAChC;AAEA,SAAKC,OAAL,GAAeF,MAAf;AACA,SAAKG,KAAL,GAAaF,QAAQG,IAArB;AACA,SAAKC,cAAL,GAAsB,EAAtB;AACD;;AAEDC,wBAAsB;AACpB,WAAO,KAAKJ,OAAL,CAAaK,QAAb,EAAP;AACD;;AACDC,qBAAmB;AACjB,UAAM,IAAIC,KAAJ,CAAU,4CAAV,CAAN;AACD;;AACDC,mBAAiB;AACf,UAAM,IAAID,KAAJ,CAAU,4CAAV,CAAN;AACD;;AACDE,kBAAgB;AACd,WAAO,KAAKT,OAAL,CAAaU,IAAb,EAAP;AACD;;AACDC,YAAU;AACR,WAAO,KAAKV,KAAZ;AACD;;AAEDW,QAAM;AAACC,WAAD;AAAUC,cAAV;AAAsBC,QAAtB;AAA4BC,UAA5B;AAAoCC;AAApC,GAAN,EAAiD;AAC/C,UAAMC,UAAU,KAAKC,eAAL,EAAhB;AACA7B,iBAAasB,KAAb,CAAmBC,WAAY,qBAAqBK,OAApD,EAA8D;AAC5DE,YAAMN,cAAcI,OADwC;AAE5DH,YAAMA,OAAOA,IAAP,GAAcM,SAFwC;AAG5DL,cAAQA,SAASA,MAAT,GAAkBK,SAHkC;AAI5DJ,YAAMA,OAAOA,IAAP,GAAcI;AAJwC,KAA9D;AAMD;AAED;;;;;;;AAKAF,oBAAkB;AAChB,WAAO,KAAKnB,OAAL,CAAasB,UAApB;AACD;AAED;;;;;;;AAKAC,iBAAe;AACb,WAAO,KAAKvB,OAAL,CAAawB,SAApB;AACD;;AAnDiD;;AAsD7C,MAAMpC,MAAN,SAAqBQ,SAArB,CAA+B;AACpC;AACA;AACA;AACA;AACA;AACA6B,gBAAc1B,OAAd,EAAuB;AACrB,SAAKI,cAAL,CAAoBuB,IAApB,cAA8B3B,OAA9B;AACD;;AARmC;;AAW/B,MAAMV,OAAN,SAAsBO,SAAtB,CAAgC;AACrC;AACA;AACA;AACA;AACA;AACA+B,gBAAc5B,OAAd,EAAuB;AACrB,SAAKI,cAAL,CAAoBuB,IAApB,cAA8B3B,OAA9B;AACD;;AARoC","file":"tools/isobuild/minifier-plugin.js.map","sourcesContent":["import buildmessage from '../utils/buildmessage.js';\nconst buildPluginModule = require('./build-plugin.js');\n\nclass InputFile extends buildPluginModule.InputFile {\n  constructor(source, options = {}) {\n    super();\n\n    this._source = source;\n    this._arch = options.arch;\n    this._minifiedFiles = [];\n  }\n\n  getContentsAsBuffer() {\n    return this._source.contents();\n  }\n  getPathInPackage() {\n    throw new Error(\"Compiled files don't belong to any package\");\n  }\n  getPackageName() {\n    throw new Error(\"Compiled files don't belong to any package\");\n  }\n  getSourceHash() {\n    return this._source.hash();\n  }\n  getArch() {\n    return this._arch;\n  }\n\n  error({message, sourcePath, line, column, func}) {\n    const relPath = this.getPathInBundle();\n    buildmessage.error(message || ('error minifying ' + relPath), {\n      file: sourcePath || relPath,\n      line: line ? line : undefined,\n      column: column ? column : undefined,\n      func: func ? func : undefined\n    });\n  }\n\n  /**\n   * @summary Returns the path of the compiled file in the bundle.\n   * @memberof InputFile\n   * @returns {String}\n   */\n  getPathInBundle() {\n    return this._source.targetPath;\n  }\n\n  /**\n   * @summary Returns the source-map associated with the file.\n   * @memberof InputFile\n   * @returns {String}\n   */\n  getSourceMap() {\n    return this._source.sourceMap;\n  }\n}\n\nexport class JsFile extends InputFile {\n  // - data\n  // - sourceMap\n  // - path\n  // - hash?\n  // - stats?\n  addJavaScript(options) {\n    this._minifiedFiles.push({ ...options });\n  }\n}\n\nexport class CssFile extends InputFile {\n  // - data\n  // - sourceMap\n  // - path\n  // - hash?\n  // - stats?\n  addStylesheet(options) {\n    this._minifiedFiles.push({ ...options });\n  }\n}\n\n"]}